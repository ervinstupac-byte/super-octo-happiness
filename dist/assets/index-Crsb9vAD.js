import{e,r as l,S as q,f as B}from"./vendor-ClkZCKU1.js";import{C as _,O as V,G as W,u as K,S as L,a as R,b as F}from"./three-vendor-DVzh5Ozl.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&c(p)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();const E=o=>{const t=(1-o)*240;return new F(`hsl(${t}, 100%, 50%)`)},x=o=>{const t=(1-o)*120;return new F(`hsl(${t}, 100%, 50%)`)};function X({pressureData:o,stressData:t}){const s=l.useRef(null),[c,r]=l.useState(!1),[a,p]=l.useState("hotpink");K((v,C)=>{!c&&s.current&&(s.current.rotation.y+=C*.5)});const f=()=>{r(!c),p(c?"hotpink":"lime")},h=t?x(t[0]):o?E(o[0]):a,S=t?x(t[1]):o?E(o[1]):"skyblue",I=t?x(t[2]):o?E(o[2]):a,w=t?x(t[3]):o?E(o[3]):a;return e.createElement("group",{ref:s,onClick:f},e.createElement(L,{args:[1,32,32],position:[0,0,0]},e.createElement("meshStandardMaterial",{color:h,metalness:.8,roughness:.2})),e.createElement(L,{args:[.4,16,16],position:[0,0,.8]},e.createElement("meshStandardMaterial",{color:S})),e.createElement(R,{args:[.5,2,4],position:[-1.5,0,0],rotation:[0,0,Math.PI/2]},e.createElement("meshStandardMaterial",{color:I,metalness:.8,roughness:.2})),e.createElement(R,{args:[.5,2,4],position:[1.5,0,0],rotation:[0,0,-Math.PI/2]},e.createElement("meshStandardMaterial",{color:w,metalness:.8,roughness:.2})))}function Y({data:o}){const[t,s]=l.useState(null);return l.useEffect(()=>{o&&new W().parse(JSON.stringify(o),"",r=>{s(r.scene)})},[o]),t?e.createElement("primitive",{object:t}):null}function Q({data:o,pressureData:t,stressData:s}){return e.createElement("div",{style:{height:"400px",backgroundColor:"#111",cursor:"pointer"}},e.createElement(_,{camera:{position:[0,3,5],fov:75}},e.createElement("ambientLight",{intensity:Math.PI/2}),e.createElement("spotLight",{position:[10,10,10],angle:.15,penumbra:1,decay:0,intensity:Math.PI}),e.createElement("pointLight",{position:[-10,-10,-10],decay:0,intensity:Math.PI}),o?e.createElement(Y,{data:o}):e.createElement(X,{pressureData:t,stressData:s}),e.createElement(V,null)))}const Z=({log:o,progress:t})=>e.createElement("div",{className:"bg-gray-800 p-4 rounded-lg mb-4"},e.createElement("h3",{className:"text-lg font-bold text-white mb-2"},"CFD Simulation Status"),e.createElement("div",{className:"w-full bg-gray-600 rounded-full h-4 mb-2"},e.createElement("div",{className:"bg-blue-500 h-4 rounded-full transition-all duration-500 ease-in-out",style:{width:`${t}%`}})),e.createElement("pre",{className:"bg-black text-white p-4 rounded-md h-64 overflow-y-auto text-sm whitespace-pre-wrap"},o)),ee="https://hydro-ai-gemini-proxy-xsldvnsqoq-uc.a.run.app/chat",te=()=>{const[o,t]=l.useState([]),[s,c]=l.useState(""),[r,a]=l.useState(!1),[p,f]=l.useState(null),h=l.useRef(null),[S,I]=l.useState(null),[w,v]=l.useState(!1),[C,M]=l.useState(""),[A,P]=l.useState(0),[j,$]=l.useState(null),[U,k]=l.useState(null),D=async n=>{const u=crypto.randomUUID();(n==="CFD Simulator"||n==="Analyze")&&(v(!0),M(""),P(0),$(null),k(null));try{const i=await fetch(ee,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n})});if(!i.ok||!i.body)throw new Error(`Proxy error: ${i.statusText}`);t(m=>[...m,{id:u,role:"model",text:""}]);const H=i.body.getReader(),T=new TextDecoder("utf-8");let N="";(async()=>{for(;;){const{done:m,value:J}=await H.read();if(m)break;const b=T.decode(J,{stream:!0});if(N+=b,n==="CFD Simulator"||n==="Analyze"){M(g=>g+b);const y=b.match(/\[PROGRESS:(\d+)\]/);y&&P(parseInt(y[1],10))}else t(y=>y.map(g=>g.id===u?{...g,text:g.text+b}:g))}try{const m=JSON.parse(N.substring(N.indexOf("{")));m.stressData&&k(m.stressData)}catch{}v(!1)})()}catch(i){console.error("Stream Error:",i),f(`API Proxy Error: ${i.message}`)}finally{a(!1)}},O=n=>{if(!n.trim()||r)return;const u={id:crypto.randomUUID(),role:"user",text:n};t(i=>[...i,u]),a(!0),f(null),D(n),c("")},z=n=>{n.preventDefault(),O(s)},d=n=>{O(n)},G=()=>{const n=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(o,null,2))}`,u=document.createElement("a");u.href=n,u.download="chat-history.json",u.click()};return l.useEffect(()=>{h.current?.scrollIntoView({behavior:"smooth"})},[o]),e.createElement("main",{className:"container mx-auto p-4 md:p-8"},e.createElement("h1",{className:"text-4xl font-bold text-white text-center mb-4"},"anohubs.com"),e.createElement(Q,{data:S,pressureData:j,stressData:U}),e.createElement("div",{className:"flex flex-wrap items-center gap-2 p-4 bg-gray-700 rounded-lg mb-4"},e.createElement("button",{onClick:()=>d("Analyze"),className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},"Analyze"),e.createElement("button",{onClick:()=>d("Investigate"),className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},"Investigate"),e.createElement("button",{onClick:()=>d("Save"),className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"},"Save"),e.createElement("button",{onClick:()=>d("Render"),className:"bg-purple-500 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded"},"Render"),e.createElement("button",{onClick:()=>d("Generate"),className:"bg-purple-500 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded"},"Generate"),e.createElement("div",{className:"border-l border-gray-500 h-8 mx-2"}),e.createElement("button",{onClick:()=>d("CFD Simulator"),className:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded"},"CFD Simulator"),e.createElement("a",{href:"https://console.cloud.google.com/storage/browser/cfd-simulation-results",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded inline-block"},"Simulation Results"),e.createElement("button",{onClick:()=>d("AppHub"),className:"bg-teal-500 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded"},"AppHub"),e.createElement("button",{onClick:G,className:"bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded"},"Export Chat")),w&&e.createElement(Z,{log:C,progress:A}),e.createElement("div",{className:"flex flex-col space-y-4 p-4 bg-gray-900 rounded-lg h-96 overflow-y-auto"},o.map(n=>e.createElement("div",{key:n.id,className:`flex ${n.role==="user"?"justify-end":"justify-start"}`},e.createElement("div",{className:`p-3 rounded-lg ${n.role==="user"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300"}`},n.text))),e.createElement("div",{ref:h})),e.createElement("form",{onSubmit:z,className:"flex space-x-3 p-4 bg-gray-800 rounded-lg shadow-lg mt-8"},e.createElement("input",{type:"text",value:s,onChange:n=>c(n.target.value),className:"flex-1 bg-transparent p-3 text-white placeholder-gray-500 focus:outline-none",disabled:r,"aria-label":"Chat input"}),e.createElement("button",{type:"submit",disabled:r||!s.trim(),className:"p-3 bg-blue-600 rounded-lg text-white disabled:bg-gray-600 disabled:cursor-not-allowed hover:bg-blue-500 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-blue-500","aria-label":"Send message"},e.createElement(q,{className:"w-6 h-6"}))))};B.createRoot(document.getElementById("root")).render(e.createElement(e.StrictMode,null,e.createElement(te,null)));
